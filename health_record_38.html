<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>개인 건강기록</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f7fb; margin:0; padding:0;}
.container { max-width: 400px; margin:30px auto; background:white; padding:20px; border-radius:10px; box-shadow:0 0 8px rgba(0,0,0,0.1); }
h2 { text-align:center; }
label { display:block; margin-top:10px; font-weight:bold; }
input, textarea { width:100%; padding:8px; margin-top:5px; border-radius:5px; border:1px solid #ccc; }
button { width:100%; margin-top:15px; padding:10px; border:none; border-radius:8px; background:#2b7cff; color:white; font-size:16px; }
.saved { text-align:center; color:green; margin-top:10px; display:none; }
</style>
</head>
<body>
<div class="container">
<h2>개인 건강기록</h2>

<label>이름</label>
<input id="name">

<label>병력 / 복용약 / 알러지</label>
<textarea id="history"></textarea>

<label>다니는 병원</label>
<input id="hospital">

<label>보호자 연락처 및 관계</label>
<input id="guardian">

<label>기타사항</label>
<textarea id="note"></textarea>

<button onclick="saveData()">저장</button>
<div class="saved" id="msg">저장 완료!</div>
</div>
<script>
const API = "https://script.google.com/macros/s/AKfycbwW_3vtk4r5yU5BPnkrxYeFE0pNDcr6hbHN7XnlDhqvQqhb_RMdNStf1IY5ej1osuJ5/exec";

// 페이지 열릴 때 서버에서 불러오기
window.onload = function () {
  fetch(API)
    .then(res => res.json())
    .then(data => {
      document.getElementById("name").value = data.name || "";
      document.getElementById("history").value = data.history || "";
      document.getElementById("hospital").value = data.hospital || "";
      document.getElementById("guardian").value = data.guardian || "";
      document.getElementById("note").value = data.etc || "";
    })
    .catch(() => console.log("아직 저장된 데이터 없음"));
};

// 서버로 저장
function saveData() {
  const data = {
    name: document.getElementById("name").value,
    history: document.getElementById("history").value,
    hospital: document.getElementById("hospital").value,
    guardian: document.getElementById("guardian").value,
    etc: document.getElementById("note").value
  };

  fetch(API, {
    method: "POST",
    body: JSON.stringify(data)
  }).then(() => {
    document.getElementById("msg").style.display = "block";
  });
}
</script>
</body>
</html>
